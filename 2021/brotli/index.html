<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.6d82a24cc2891ca3975f.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 3.11.1"/><title data-react-helmet="true">웹을 위한 더 나은 압축 - Brotli | 명시지(形式知)</title><link data-react-helmet="true" rel="alternate" type="application/rss+xml" title="명시지(形式知) - 기록할 수 있는 지식을 나눕니다" href="/rss.xml"/><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link data-react-helmet="true" rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link data-react-helmet="true" rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link data-react-helmet="true" rel="manifest" href="/favicon/site.webmanifest"/><link data-react-helmet="true" href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;600&amp;display=swap" rel="stylesheet"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:title" content="웹을 위한 더 나은 압축 - Brotli"/><meta data-react-helmet="true" property="og:description" content="웹을 위한 강력한 압축 Brotli와 Brotli의 핵심 아이디어를 알아봅시다."/><meta data-react-helmet="true" property="og:image" content="/static/14683e5361ba445ba34c648fc3ec21ca/87139/brotli.png"/><meta data-react-helmet="true" property="og:author" content="이한"/><meta data-react-helmet="true" property="og:site_name" content="명시지(形式知) - 기록할 수 있는 지식을 나눕니다"/><meta data-react-helmet="true" property="article:published_time" content="2021-08-28"/><meta data-react-helmet="true" name="msapplication-TileColor" content="#000000"/><meta data-react-helmet="true" name="theme-color" content="#000000"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><style id="stitches">--stitches{--:1 enCcya hBRgbT}@media{html{margin:0;padding:0;width:100%;height:100%}body{margin:0;padding:0;width:100%;height:100%;color:#495057}#___gatsby{width:100%;height:100%}#gatsby-focus-wrapper{width:100%;height:100%}body{font-family:sans-serif}:not(pre) > code[class*="language-"]{background-color:#F8F9FA}pre[class*="language-"]{background-color:#F8F9FA;border-radius:16px}}--stitches{--:2 c-kSdbTs c-fUYROz c-cklUpd c-kcIPMQ c-hlRxgL}@media{.c-kSdbTs{padding-bottom:env(safe-area-inset-bottom, 0)}.c-fUYROz{max-width:800px;margin:0 auto;padding:30px}@media(max-width: 600px){.c-fUYROz{padding:15px}}.c-cklUpd{word-break:keep-all}.c-cklUpd a{color:#1C7ED6;text-decoration:none}.c-cklUpd blockquote{margin:0;padding:1px 16px;color:#868E96;border-left:5px solid #E9ECEF}.c-cklUpd blockquote p{margin:10px 0}.c-kcIPMQ{font-size:36px;margin:0}.c-hlRxgL{color:#868E96;text-decoration:none;margin:15px 0;display:inline-block}}</style><link as="script" rel="preload" href="/webpack-runtime-1b8213d0ddf009a604ca.js"/><link as="script" rel="preload" href="/framework-4c82f2c0baf06da7d4bc.js"/><link as="script" rel="preload" href="/app-42984d940a43d77eea6b.js"/><link as="script" rel="preload" href="/commons-e25784072fbf66df1ec7.js"/><link as="script" rel="preload" href="/component---src-containers-post-tsx-6cd70a4c78806dd62d88.js"/><link as="fetch" rel="preload" href="/page-data/2021/brotli/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><main class="c-kSdbTs"><div class="c-fUYROz"><article class="c-cklUpd"><header><h1 class="c-kcIPMQ">웹을 위한 더 나은 압축 - Brotli</h1><p>2021-08-28</p></header><p>웹사이트에서 용량은 매우 중요합니다. 많은 웹사이트에서 빠른 전송 속도를 위해 gzip으로 압축하고 있습니다.</p><p>그런데 웹 브라우저가 지원하는 압축 알고리즘 중에는 gzip 보다 더 효율적인 압축도 있습니다.</p><p><a href="https://github.com/google/brotli">Brotli</a>는 구글이 2013년에 공개한 압축 알고리즘입니다.
현재 <a href="https://caniuse.com/brotli">IE를 제외한 대부분 브라우저</a>에서 지원하며, gzip에 비해 <a href="https://www.siteground.com/blog/brotli-compression/">최대 15-20% 더 적은 용량</a>으로 압축할 수 있습니다.</p><p>Brotli은 어떻게 gzip 보다 더 나은 압축을 제공해주는 걸까요?</p><h1>압축</h1><p>압축에는 손실 압축, 무손실 압축 두가지 종류가 있습니다.</p><h2>손실 압축</h2><p>손실 압축의 좋은예는 mp3 입니다. 인간은 들을수 있는 주파수(가청 주파수)가 한정되어 있습니다.
들을 수 없는 주파수 데이터를 지운다면 용량은 줄어들지만 차이를 느끼지 못할겁니다. </p><p>이렇듯 원본과 조금 달라도 괜찮은 이미지, 영상, 음원에는 손실 압축이 많이 사용됩니다.</p><h2>무손실 압축</h2><p>하지만 자바스크립트, HTML은 압축후에도 원본을 유지해야합니다.
텍스트에서 무손실 압축은 반복되는 단어를 사전으로 만드는 것과 같습니다. 별 헤는 밤의 일부분을 압축하며 설명해보겠습니다.</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">별 하나에 추억과
별 하나에 사랑과
별 하나에 쓸쓸함과
별 하나에 동경과
별 하나에 시와
별 하나에 어머니, 어머니,</code></pre></div><p>시에선 <code class="language-text">별 하나에 </code>와 <code class="language-text">어머니,</code>가 반복되는걸 볼 수 있습니다. <code class="language-text">별 하나에</code>를 <code class="language-text">✩</code>로, <code class="language-text">어머니,</code>를 <code class="language-text">⺟</code>로 바꿔보죠</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">✩추억과
✩사랑과
✩쓸쓸함과
✩동경과
✩시와
✩⺟ ⺟</code></pre></div><p>이렇게 자주 반복되는 단어를 더 짧은 단어로 수정하면 글자수가 줄어들게 됩니다.
압축 알고리즘은 이렇게 반복되는 단어를 더 짧은 단어로 치환하고, 사전을 함께 묶어 파일로 만듭니다.
압축을 풀때는 사전을 이용해 원래 문장으로 복구하는 것이죠.</p><p>여러 압축 알고리즘은 &#x27;좋은 사전을 얼마나 빨리 만드는가?&#x27;를 달성하기 위해 노력합니다.
재미있는 사실은 사전을 만들때 자주 반복되는 단어가 가까이 있을 수록 더 효율적으로 압축할 수 있어, <a href="https://stackoverflow.com/questions/50578582/does-alphabetically-sorting-css-properties-will-give-any-benefit-in-gzip-and-bro">CSS 속성을 어떻게 정렬하는가</a>도 압축효율에 영향을 줄 수 있습니다.</p><h1>더 나은 사전 만들기</h1><p>여기서 Brotli 압축의 재미있는 아이디어가 나옵니다.</p><p>웹에선 반복되는 단어가 많습니다. HTML에서는 <code class="language-text">div</code>, <code class="language-text">a</code>와 같은 태그들, 자바스크립트에서는 <code class="language-text">function</code>, <code class="language-text">let</code>과 같은 예약어와 <code class="language-text">Math</code> <code class="language-text">fetch</code>와 같은 Web API, CSS에서는 각종 CSS 속성들이 반복되어 사용되죠.</p><p>Brotli는 이런 웹에서 자주사용되는 단어로 미리 사전을 만들어두었습니다. 자주 사용되는 단어들인 만큼 효율적인데다가, 이 사전은 브라우저에서 미리 가지고 있도록해 사전의 용량도 추가적으로 줄일 수 있습니다.
범용적이진 않지만, 웹에서는 그야말로 딱인 압축 방법이지요. (참고로 Brotli는 동적인 사전 또한 가지고 있습니다.)</p><p>이러한 이유로 Brotli는 반복되는 태그가 많은 HTML에서 가장 좋은 효율을 보입니다.</p><h1>Brotli 사용하기</h1><p>Brotli를 사용할 수 있다면, 웹 브라우저에서는 <a href="https://developer.mozilla.org/ko/docs/Web/HTTP/Headers/Content-Encoding">Accept-Encoding</a> 헤더값으로 <code class="language-text">br</code>을 넣어서 전달합니다.</p><p>지금 사용하시는 웹브라우저의 개발자도구를 켜시면 대부분 <code class="language-text">Accept-Encoding: gzip, br</code> 헤더가 전달되는 것을 보실 수 있습니다.
서버에서는 이 헤더 값을 기준으로 사용할 수 있을때 Brotli로 압축하여 전달하면 됩니다.</p><h2>AWS</h2><p>AWS를 사용하신다면 <a href="https://aws.amazon.com/ko/about-aws/whats-new/2020/09/cloudfront-brotli-compression/">작년 9월 부터 CloudFront에서 지원하고 있어</a> 간단히 사용하실 수 있습니다.</p><p>지금 다니고 있는 회사에서도 Brotli 압축을 사용하는데, 사실 여러 벤치마크에서 처럼 드라마틱한 효과를 보진 못했습니다. 대략 5% 정도 더 효율적 이었던 걸로 기억합니다.
하지만 간단히 용량을 줄일 수 있는 몇 안되는 방법이며, 대규모 트래픽이 몰리는 서비스에선 분명히 비용개선에 도움이 될 것이라 생각합니다.</p><p>더 많은 웹사이트에서 Brotli 압축을 보면 좋겠습니다 :)</p></article><a class="c-hlRxgL" href="/">← 글 목록</a></div><section></section></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-111601591-4', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2021/brotli";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-bd312ff6d8fd834f2338.js"],"app":["/app-42984d940a43d77eea6b.js"],"component---src-containers-category-tsx":["/component---src-containers-category-tsx-668627339b6271b03be8.js"],"component---src-containers-post-tsx":["/component---src-containers-post-tsx-6cd70a4c78806dd62d88.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-afb7e67e168c25dc64b4.js"]};/*]]>*/</script><script src="/polyfill-bd312ff6d8fd834f2338.js" nomodule=""></script><script src="/component---src-containers-post-tsx-6cd70a4c78806dd62d88.js" async=""></script><script src="/commons-e25784072fbf66df1ec7.js" async=""></script><script src="/app-42984d940a43d77eea6b.js" async=""></script><script src="/framework-4c82f2c0baf06da7d4bc.js" async=""></script><script src="/webpack-runtime-1b8213d0ddf009a604ca.js" async=""></script></body></html>