<!doctype html>
<html ⚡>
    <head>
        <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000">
<meta name="msapplication-TileColor" content="#000000">
<meta name="theme-color" content="#000000">

<title>고밀도 디스플레이를 위한 이미지 다루기 | sn0wle0pard</title>
<link rel="stylesheet" href="/css/style.css">

    <link rel="stylesheet" href="/css/prism-okaidia.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>
    <body>
        <header class="header">
  <div class="header-container">
    <a class="blog-title" href="/">
      sn0wle0pard
    </a>
    <ul class="blog-nav">
      
        <li class="menu-item">
          <a href="/">Home</a>
        </li>
      
        <li class="menu-item">
          <a href="http://sn0wle0pard.io">About</a>
        </li>
      
    </ul>
  </div>
</header>
        <main class="container">
            <article id="article">
    <header id="article-title" class="text-center">
    <h1>고밀도 디스플레이를 위한 이미지 다루기</h1>
    <div id="time">
    <time datetime="2018-01-20T15:00:00.000Z" itemprop="datePublished">2018-01-21</time>
    </div>
</header>

<section>
    <h1 id="들어가며"><a href="#들어가며" class="headerlink" title="들어가며"></a>들어가며</h1>
<link rel="stylesheet" href="./retina.css">
<p class="normal">이 문장이 보인다면 <span class="red">고밀도 디스플레이</span>가 아닙니다.</p>
<p class="retina">이 문장이 보인다면 <span class="blue">고밀도 디스플레이</span> 입니다.</p>

<p>레티나 디스플레이를 시작으로 다양한 고밀도 디스플레이 기기가 늘어났습니다. 이에 따라 웹 환경에서도 2x 이미지를 </p>
<h1 id="Media-Queries-resolution-feature"><a href="#Media-Queries-resolution-feature" class="headerlink" title="Media Queries: resolution feature"></a>Media Queries: resolution feature</h1><p><code>resolution</code>은 고밀도 디스플레이를 위해 고안된 css문법으로,
IE9를 포함한 <a href="https://caniuse.com/#feat=css-media-resolution" target="_blank" rel="noopener">브라우저 대부분</a>이 지원합니다.
문법은 <code>(min/max)-resolution: 값</code>으로 사용되며, 기본 단위는 dppx입니다.</p>
<p>이 미디어쿼리를 사용하면 고밀도 디스플레이와 저밀도 디스플레이에 서로 다른 이미지를 보여줄 수 있습니다.</p>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>some_img.ext<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img-normal<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>normal image<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>some_img@2x.ext<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img-retina<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>retina image<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.img-retina</span> </span><span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> only screen and <span class="token punctuation">(</span><span class="token property">min-resolution</span><span class="token punctuation">:</span> 2<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector"><span class="token class">.img-retina</span> </span><span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> initial<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector"><span class="token class">.img-normal</span> </span><span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>background-image</code>를 사용할 것이면 다음과 같이 쓸 수 있습니다.</p>
<pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.img-retina</span> </span><span class="token punctuation">{</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url(...)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> only screen and <span class="token punctuation">(</span><span class="token property">min-resolution</span><span class="token punctuation">:</span> 2<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector"><span class="token class">.img-retina</span> </span><span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url(...)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>하지만 아쉽게도 safari는 <code>min/max-device-pixel-ratio</code> 문법만을 지원하고 있어 다음을 사용해야 합니다.</p>
<pre class="line-numbers language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@media</span> only screen and <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span> 2<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">/**/</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>또한 오페라미니와 IE는 dppx를 지원하지 않기 때문에 적당한 dpi를 사용해야 합니다.</p>
<pre class="line-numbers language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@media</span> only screen and <span class="token punctuation">(</span><span class="token property">min-resolution</span><span class="token punctuation">:</span> 192dpi<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">/**/</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>결과적으로 IE9을 포함한 대부분 브라우저를 지원하려면 다음 문법을 사용하면 됩니다.</p>
<pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.img-retina</span> </span><span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> only screen and <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span> 2<span class="token punctuation">)</span>, only screen and <span class="token punctuation">(</span><span class="token property">min-resolution</span><span class="token punctuation">:</span> 192dpi<span class="token punctuation">)</span>, only screen and <span class="token punctuation">(</span><span class="token property">min-resolution</span><span class="token punctuation">:</span> 2dppx<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector"><span class="token class">.img-retina</span> </span><span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> initial<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector"><span class="token class">.img-normal</span> </span><span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>덤으로 만약 파이어 폭스와 오페라 이전 버전을 지원하고 싶다면 다음과 같은 미디어 쿼리를 추가하면 됩니다.</p>
<pre class="line-numbers language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@media</span> only screen and <span class="token punctuation">(</span><span class="token property">min--moz-device-pixel-ratio</span><span class="token punctuation">:</span> 2<span class="token punctuation">)</span>, only screen and <span class="token punctuation">(</span><span class="token property">-o-min-device-pixel-ratio</span><span class="token punctuation">:</span> 2/1<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">/**/</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><code>resolution</code> 미디어 쿼리를 사용하면, 브라우저 대부분을 지원하자만, 그러기 위해서는 미디어 쿼리가 복잡해지는 문제가 있습니다.
게다가 한가지 문제가 더 생기는데 브라우저의 <strong>동시 연결 제한</strong> 문제입니다.</p>
<h1 id="동시-연결-제한"><a href="#동시-연결-제한" class="headerlink" title="동시 연결 제한"></a>동시 연결 제한</h1><p>HTTP 1.1의 표준인 <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html#sec8.1.4" target="_blank" rel="noopener">RFC 2616</a>의 8.1.4절을 살펴보면 다음과 같은 내용이 있습니다.</p>
<blockquote>
<p>Clients that use persistent connections SHOULD limit the number of simultaneous connections that they maintain to a given server.</p>
</blockquote>
<p>한국전자통신연구소의 번역본은 다음과 같습니다.</p>
<blockquote>
<p>지속적인 접속을 사용하는 클라이언트는 특정 서버로의 동시 접속 숫자에 제한을 두어야 한다.</p>
</blockquote>
<p>실제로 브라우저들은 <em>도메인당 최대 연결수를 제한하고 있습니다</em>. 그 수는 브라우저 마다 다릅니다.</p>
<table>
<thead>
<tr>
<th>브라우저</th>
<th>도메인당 최대 연결 수</th>
</tr>
</thead>
<tbody>
<tr>
<td>Internet Explorer® 7.0</td>
<td>2</td>
</tr>
<tr>
<td>Internet Explorer 8.0 &amp; 9.0</td>
<td>6</td>
</tr>
<tr>
<td>Internet Explorer 10.0</td>
<td>8</td>
</tr>
<tr>
<td>Internet Explorer 11.0</td>
<td>13</td>
</tr>
<tr>
<td>Firefox®</td>
<td>6</td>
</tr>
<tr>
<td>Chrome™</td>
<td>6</td>
</tr>
<tr>
<td>Safari®</td>
<td>6</td>
</tr>
<tr>
<td>Opera®</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>사파리를 예로 들면, 한 웹페이지의 같은 도메인 한번에 받아 올 수 있는 이미지는 최대 6개 입니다.</p>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-1.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-2.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-3.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-4.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-5.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-6.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-7.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-8.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-9.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-10.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-11.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-12.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<img src="/2018/high-density-display-and-images/img/img-load.png" title="사파리 이미지 로딩">
<p>위 이미지를 보시면 최대 6개의 네트워크 연결을 확인할 수 있습니다.</p>
<p><a href="./same-domain-multiple-images.html">여기에서</a> 직접 확인해 보실 수 있습니다.</p>
<blockquote>
<p>동일 도메인 연결 제한을 피하고 성능향상을 위해 CDN 서비스를 사용하기도 합니다. </p>
</blockquote>
<p>중요한 점은 브라우저는 보여지지 않는 파일도 가져옵니다. 즉, <code>display: none</code> 혹은
무시된 <code>background-image</code>도 가져옵니다.</p>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-1.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-2.png<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span> none</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-3.png<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span> none</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-4.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-5.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-6.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-7.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-8.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-9.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-10.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-11.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./img/normal-img-12.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<img src="/2018/high-density-display-and-images/img/img-load-with-none.png" title="display:none 이미지">
<p>위 이미지를 확인해 보시면 사용하지 않는 <code>normal-img-2.png</code>와 <code>normal-img-3.png</code>도 받아오는걸 확인 할 수 있습니다.</p>
<p>마찬가지로 <a href="./same-domain-multiple-images-with-none.html">여기에서</a> 확인할 수 있습니다.</p>
<p>결국 resolution 미디어 쿼리를 이용해 이미지를 다룰경우, 불필요한 이미지도 모두 받아오게 됩니다.
따라서 고밀도 유저나 일반 유저나 모두 약 2배 가까운 이미지를 받게됩니다. 여러 이미지를 사용하는 페이지라면,
보이지 않는 이미지를 받는 도중 도메인 연결 제한에 걸려 보여줘야할 이미지를 받는데 더 시간이 걸릴 수도 있습니다.</p>
<blockquote>
<p>단, background-image를 이용할 경우에는 필요한 이미지만 받아옵니다.
따라서 가능하다면 <strong>보여줘야할 이미지만 선택해서 받아오게 해야합니다</strong>. 그럼 다른 방법은 없을 까요?</p>
</blockquote>
<h1 id="JS를-이용해-동적으로-가져오기"><a href="#JS를-이용해-동적으로-가져오기" class="headerlink" title="JS를 이용해 동적으로 가져오기"></a>JS를 이용해 동적으로 가져오기</h1><p><code>window.devicePixelRatio</code> (<a href="https://caniuse.com/#feat=devicepixelratio" target="_blank" rel="noopener">IE 11</a>부터 지원)을 사용하거나,
위에 있는 미디어 쿼리를 적용한 element 상태를 보고 적합한 이미지를 가져오는 방법도 있습니다.</p>
<p>이 방식을 사용하실 거면, <a href="https://github.com/strues/retinajs" target="_blank" rel="noopener">retinajs</a>를 추천합니다.
retinajs는 css js를 모두 지원하고 특히 다음과 같은 문법을 지원하는데요,</p>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/images/my_image.png<span class="token punctuation">"</span></span>
  <span class="token attr-name">data-rjs</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/images/my-image@2x.png<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>

<span class="token comment" spellcheck="true">&lt;!-- or --></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name">
  <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background</span><span class="token punctuation">:</span> <span class="token url">url(/images/my_image.png)</span></span><span class="token punctuation">"</span></span>
  <span class="token attr-name">data-rjs</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/images/my-image@2x.png<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>이렇게 사용하면, 일반 디스플레이 이용자들은 <code>/images/my_image.png</code>만을 받아 올 수 있습니다.</p>
<p>하지만 여전히 고밀도 이용자들은 여러 이미지를 받거나, 깜박임을 겪는 문제를 겪습니다.</p>
<h1 id="srcset"><a href="#srcset" class="headerlink" title="srcset"></a>srcset</h1><p>HTML 5.1 부터 img element에 <a href="https://www.w3.org/TR/html51/semantics-embedded-content.html#element-attrdef-img-srcset" target="_blank" rel="noopener">srcset</a> 속성이 추가 되었습니다.
현재 IE와 오페라미니를 제외한 모든 브라우저 에서 <a href="https://caniuse.com/#feat=srcset" target="_blank" rel="noopener">지원하고 있습니다</a>.</p>
<p><code>srcset</code>은 조건에 따라 다른 이미지를 가져오게 할 수 있는데요 다음과 같은 문법으로 사용합니다.</p>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>...<span class="token punctuation">"</span></span> <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>[이미지위치] [조건], ...<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>쉼표로 구분하며, 앞에 조건과 사용할 이미지를 적으면 됩니다.
<code>resolution</code>이 2이상인 디스플레이와 일반디스플레이를 구분해 이미지를 보여주려면 다음과 같이 사용합니다.</p>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>image-src.png<span class="token punctuation">"</span></span> <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>image-1x.png 1x, image-2x.png 2x<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>srcset을 사용하면 브라우저는 적합한 이미지만을 선택해 가져옵니다.
<img src="/2018/high-density-display-and-images/img/webkit-2x.png">
위 이미지를 보시면 <code>image-src.png</code>나 <code>image-1x.png</code>를 받지 않고 <code>image-2x.png</code>만 받는걸 확인 할 수 있습니다.
<a href="https://webkit.org/demos/srcset/" target="_blank" rel="noopener">여기에서</a> 직접 확인해 볼 수 있습니다.</p>
<p>어떤 조건에도 해당 되지 않거나, 이미지를 가져올 수 없다면 <code>src</code>에 있는 이미지를 가져오게 됩니다.</p>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>image-src.png<span class="token punctuation">"</span></span> <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>image-2x.png 2x<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>예를 들어 위와 같이 작성하면 2x, 3x … 밀도를 가진 기기는 <code>image-2x.png</code>를 가져오고,
<code>srcset</code>을 지원하지 않는 브라우저나 일반 디스플레이는 <code>image-src.png</code>을 가져오게 됩니다.</p>
<p>따라서 <code>srcset</code>을 지원하지 않는 브라우저도 (비록 상대적으로 흐린 이미지 겠지만) 이미지 자체는 표시가 될 뿐더러,
불필요한 이미지를 가져오지 않아, 성능에도 도움이 됩니다.</p>
<h2 id="덤"><a href="#덤" class="headerlink" title="덤"></a>덤</h2><p><code>srcset</code>으로 가져온 이미지는 한가지 특징을 가지게 됩니다.</p>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>image-src.png<span class="token punctuation">"</span></span> <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>image-2x.png 2x<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>다음과 같이 HTML을 작성하였고, image-2x.png는 200px<em>200px 크기의 이미지 라면,
<code>img</code>에 <code>width: 100%</code>를 주었어도 100px</em>100px으로 표시됩니다.</p>
<p>따라서 이미지 크기를 반드시 2배 키워서 사용해야 크기 실수를 방지 할 수 있습니다.
safari는 개발자용 &gt; 응답형디자인모드 에서 최대 3x 까지 디스플레이 밀도를 조정하며 확인해 볼 수 있습니다.</p>
<h3 id="img-set"><a href="#img-set" class="headerlink" title="img-set"></a>img-set</h3><p>css에도 img-set이란 속성이 있습니다. 아쉽게도 현재는 사파리와 크롬만 <a href="https://caniuse.com/#search=image-set" target="_blank" rel="noopener">지원하고</a> 있는데요,
다음과 같은 방법으로 사용할 수 있습니다.</p>
<pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.test</span> </span><span class="token punctuation">{</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url(image-1x.png)</span><span class="token punctuation">;</span> 
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">-webkit-image-set</span><span class="token punctuation">(</span><span class="token url">url(image-1x.png)</span> <span class="token number">1</span>x, <span class="token url">url(image-2x.png)</span> <span class="token number">2</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span><span class="token number">75</span>px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>아쉽게도 사파리와 크롬만 지원하지만 <code>srcset</code>처럼 fallback이 있으므로 콘텐츠에 문제를 만들지 않으며, 적합한 이미지만 골라 받아 오게 됩니다.</p>
<p>하지만,</p>
<pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.img-retina</span> </span><span class="token punctuation">{</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url(...)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@media</span> only screen and <span class="token punctuation">(</span><span class="token property">min-resolution</span><span class="token punctuation">:</span> 2<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector"><span class="token class">.img-retina</span> </span><span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url(...)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>위의 css를 사용해도 적합한 파일만을 받기 때문에 현재로썬 복잡한 미디어 쿼리를 작성하기 싫을 경우에 유용합니다.</p>
<h1 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h1><ul>
<li>문서 상단처럼 고밀도 디스플레이에 서로 다른 HTML Element를 보여줘야 한다</li>
<li>동적으로 이미지를 가져오는 것이 싫다</li>
<li>IE에도 고해상도 이미지를 보여주고 싶다</li>
</ul>
<p><code>resolution</code> 미디어 쿼리를 이용하세요. </p>
<ul>
<li>IE를 지원해야 합니다</li>
<li>동적으로 이미지를 가져와도 좋다.</li>
</ul>
<p>자바스크립트를 이용해 구현하여 사용합니다. 개인적으로는 retinajs를 추천합니다.</p>
<p>그외의 경우에는 <code>srcset</code>과 사용하시는 것을 권장합니다.</p>

</section>
<footer id="article-footer">
    <div id="article-tag">
        
    </div>
</footer>
<div id="share">
    <div class="article-share-box">
    <span>SHARE THIS ARTICLE</span>
    <div class="article-share-links">
        <a 
            href="https://www.facebook.com/sharer.php?u="
            id="share-link-facebook"
            target="_blank" title="Facebook">
            <img src="/icon/facebook.svg"/>
        </a>
        <a
            href="https://twitter.com/intent/tweet?url="
            id="share-link-twitter"
            target="_blank" title="Twitter">
            <img src="/icon/twitter.svg"/>
        </a>
    </div>
</div>

</div>
<div class="fb-comments" data-href="https://blog.sn0wle0pard.io/2018/high-density-display-and-images/" data-width="100%" data-numposts="5"></div>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = 'https://connect.facebook.net/ko_KR/sdk.js#xfbml=1&version=v2.11&appId=155425561701021';
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
</article>


        </main>
        
        
        <script src="/js/share.js"></script>
        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-111601591-1', 'auto');
            ga('send', 'pageview');
        </script>
        
    </body>
</html>
