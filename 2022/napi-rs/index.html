<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.20.0"/><meta property="og:type" content="article" data-gatsby-head="true"/><meta property="og:title" content="Node.jsì™€ Rustì˜ ìš°ì•„í•œ ê²°í•© napi-rs" data-gatsby-head="true"/><meta property="og:description" content="ì–´ì©Œë©´ ê°€ì¥ ë©‹ì§„ ë§Œë‚¨" data-gatsby-head="true"/><meta property="og:image" content="/static/cde027f2263994b6dd5d65944c3d9e28/a145d/thumbnail.png" data-gatsby-head="true"/><meta property="og:author" content="ì´í•œ" data-gatsby-head="true"/><meta property="og:site_name" content="ëª…ì‹œì§€(æ˜ç¤ºçŸ¥) - ê¸°ë¡í•  ìˆ˜ ìˆëŠ” ì§€ì‹ì„ ë‚˜ëˆ•ë‹ˆë‹¤" data-gatsby-head="true"/><meta name="msapplication-TileColor" content="#000000" data-gatsby-head="true"/><meta name="theme-color" content="#000000" data-gatsby-head="true"/><meta property="article:author" content="ì´í•œ" data-gatsby-head="true"/><meta name="twitter:card" content="summary" data-gatsby-head="true"/><meta name="twitter:creator" content="@hanleedev" data-gatsby-head="true"/><meta name="twitter:image" content="/static/cde027f2263994b6dd5d65944c3d9e28/a145d/thumbnail.png" data-gatsby-head="true"/><meta name="twitter:label1" content="ì½ëŠ” ì‹œê°„" data-gatsby-head="true"/><meta name="twitter:data1" content="4ë¶„" data-gatsby-head="true"/><style data-href="/styles.618336a6b0dc03f16839.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Pretendard;font-weight:900;src:local("Pretendard Black"),url(/static/Pretendard-Black-14a71ec59ff2b3bc6933d54c6ee04ff1.woff2) format("woff2"),url(/static/Pretendard-Black-fe80bd8c7ce9b3af972f6e99a5646522.woff) format("woff")}@font-face{font-display:swap;font-family:Pretendard;font-weight:800;src:local("Pretendard ExtraBold"),url(/static/Pretendard-ExtraBold-55bef92e8f01b6b6ef2f8d31fdc0f951.woff2) format("woff2"),url(/static/Pretendard-ExtraBold-82ea4400a5eea299b40c94aac01985ba.woff) format("woff")}@font-face{font-display:swap;font-family:Pretendard;font-weight:700;src:local("Pretendard Bold"),url(/static/Pretendard-Bold-0676c8838a37a3b770d85a5534f5fdcb.woff2) format("woff2"),url(/static/Pretendard-Bold-f6866c5eb21ccb9a8749d3a2874a7e6e.woff) format("woff")}@font-face{font-display:swap;font-family:Pretendard;font-weight:600;src:local("Pretendard SemiBold"),url(/static/Pretendard-SemiBold-7e5eaaf650b9e738991373a7f173b94a.woff2) format("woff2"),url(/static/Pretendard-SemiBold-a0c72d6162af72df37ec279440595738.woff) format("woff")}@font-face{font-display:swap;font-family:Pretendard;font-weight:500;src:local("Pretendard Medium"),url(/static/Pretendard-Medium-ea235f1edb8815831a25b376b479949e.woff2) format("woff2"),url(/static/Pretendard-Medium-f902522b86842449110e07cbc07b8346.woff) format("woff")}@font-face{font-display:swap;font-family:Pretendard;font-weight:400;src:local("Pretendard Regular"),url(/static/Pretendard-Regular-6090e6b5524796768e78f23519d16488.woff2) format("woff2"),url(/static/Pretendard-Regular-ab56c53f21ca6b32d15fe0ae8daf5f60.woff) format("woff")}@font-face{font-display:swap;font-family:Pretendard;font-weight:300;src:local("Pretendard Light"),url(/static/Pretendard-Light-27c9a07cbc308ce88d1ab3613e3152c7.woff2) format("woff2"),url(/static/Pretendard-Light-40808ea4485a78c05f9213ed583b0046.woff) format("woff")}@font-face{font-display:swap;font-family:Pretendard;font-weight:200;src:local("Pretendard ExtraLight"),url(/static/Pretendard-ExtraLight-1a26bede4e9bc7d2e9c0ce548cd4cf83.woff2) format("woff2"),url(/static/Pretendard-ExtraLight-ff5e73a97b5e7a5c5d5fed684594e8ad.woff) format("woff")}@font-face{font-display:swap;font-family:Pretendard;font-weight:100;src:local("Pretendard Thin"),url(/static/Pretendard-Thin-41861ab4e67767c4c6ed0b5e361fbca6.woff2) format("woff2"),url(/static/Pretendard-Thin-348f24715998d74e9f5529afd376f55b.woff) format("woff")}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><title data-gatsby-head="true">Node.jsì™€ Rustì˜ ìš°ì•„í•œ ê²°í•© napi-rs | </title><link rel="alternate" type="application/rss+xml" title="ëª…ì‹œì§€(æ˜ç¤ºçŸ¥) - ê¸°ë¡í•  ìˆ˜ ìˆëŠ” ì§€ì‹ì„ ë‚˜ëˆ•ë‹ˆë‹¤" href="/rss.xml" data-gatsby-head="true"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" data-gatsby-head="true"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png" data-gatsby-head="true"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png" data-gatsby-head="true"/><link rel="manifest" href="/favicon/site.webmanifest" data-gatsby-head="true"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="alternate" type="application/rss+xml" title="ëª…ì‹œì§€ (æ˜ç¤ºçŸ¥)" href="/rss.xml"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><style id="stitches">--sxs{--sxs:0 t-gdxNDc}@media{:root,.t-gdxNDc{--colors-gray000:#F8F9FA;--colors-gray100:#F1F3F5;--colors-gray200:#E9ECEF;--colors-gray300:#DEE2E6;--colors-gray400:#CED4DA;--colors-gray500:#ADB5BD;--colors-gray600:#868E96;--colors-gray700:#495057;--colors-gray800:#343A40;--colors-gray900:#212529;--colors-blue700:#1C7ED6}}--sxs{--sxs:1 hKePEu}@media{body{padding:0;margin:0;font-size:16px;color:var(--colors-gray800);font-weight:400;font-family:Pretendard,sans-serif}*{box-sizing:border-box}}--sxs{--sxs:2 c-bSvfqS c-hEdiuM c-drslhw c-gGqMDa c-jEDjTQ c-dvRuTq c-bZcNek c-jwOSHF c-dMmbPO c-euCchw c-boZbfK c-gBKazA c-eXJruw c-fzsocY c-eJVyyl c-fXXVzC c-hdzxtM c-dpWDmP c-bxCTAm c-jDcCnV c-bvNJHJ c-bHVmPA}@media{.c-bSvfqS{max-width:1000px;padding:24px;margin:0 auto}.c-hEdiuM{width:36px;height:36px}.c-drslhw{font-size:18px;line-height:1.8;word-break:keep-all}.c-drslhw h1,.c-drslhw h2,.c-drslhw h3,.c-drslhw p{margin-top:0;margin-bottom:12px}.c-drslhw h1,.c-drslhw h2,.c-drslhw h3{font-weight:600}.c-drslhw h1{font-size:1.5rem}.c-drslhw h2{font-size:1.25rem}.c-drslhw h3{font-size:1.15rem}.c-drslhw p code{font-size:16px;line-hight:16;padding:1px 4px;border-radius:4px;margin-right:2px;background-color:var(--colors-gray000);border:1px solid var(--colors-gray200)}.c-drslhw a{color:var(--colors-blue700);text-decoration:none}.c-drslhw blockquote{margin:12px 0;padding:1px 16px;color:var(--colors-gray600);border-left:5px solid var(--colors-gray200)}.c-drslhw blockquote p{margin:4px 0}.c-drslhw iframe{display:block;max-width:100%;margin:0 auto;margin-bottom:18px}.c-drslhw pre[class*="language-"]{font-size:16px;border-radius:8px;border:1px solid var(--colors-gray200);background-color:var(--colors-gray000)}.c-drslhw pre[class*="language-"] .token.operator{background-color:transparent}.c-drslhw pre[class*="language-"] .gatsby-highlight-code-line{display:block;background-color:var(--colors-gray200);margin-left:-16px;margin-right:-16px;padding-left:16px}.c-drslhw .footnotes hr{border-top:none;border-color:var(--colors-gray200)}.c-gGqMDa{font-size:2rem;font-weight:600;margin-bottom:0 !important}.c-jEDjTQ{display:flex;align-items:center;margin-top:24px;background-color:var(--colors-gray000);border-radius:16px;padding:16px}.c-dvRuTq{width:72px;height:72px;border-radius:50%}.c-bZcNek{flex:1;margin-left:24px}.c-jwOSHF{margin:0;font-size:1.25rem;color:var(--colors-gray700);font-weight:600}.c-dMmbPO{margin:6px 0;font-weight:400;color:var(--colors-gray600)}.c-euCchw{font-size:0.85rem;color:var(--colors-gray600);margin-right:8px}.c-boZbfK{max-width:1000px;padding:100px 24px;margin:0 auto}@media screen and (max-width: 1000px){.c-boZbfK{padding:60px 24px}}.c-gBKazA{margin-bottom:24px}.c-eXJruw{color:var(--colors-gray700);font-size:1.75rem;font-weight:600;margin:0}.c-fzsocY{color:var(--colors-gray500);font-size:1.25rem}.c-eJVyyl{margin:0;margin-top:6px;color:var(--colors-gray600);font-weight:300;font-size:1rem}.c-fXXVzC{margin:0;padding:0}.c-hdzxtM{list-style:none;border-bottom:1px solid var(--colors-gray100)}.c-hdzxtM:last-child{border:none}.c-jDcCnV{font-size:1.25rem;color:var(--colors-gray700);font-weight:600;margin:0}.c-bvNJHJ{margin:0;margin-top:6px;color:var(--colors-gray600);font-weight:400}.c-bxCTAm{padding:16px;word-break:keep-all}.c-bxCTAm:hover{border-radius:12px;background-color:var(--colors-gray000)}.c-dpWDmP{display:block;text-decoration:none}.c-bHVmPA{width:100%;border-radius:16px}}</style></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><main class="c-bSvfqS"><header><a href="/"><img src="/images/logo.png" draggable="false" alt="ë¸”ë¡œê·¸ ë¡œê³ " width="36" height="36" class="c-hEdiuM"/></a></header><article class="c-drslhw"><h1 class="c-gGqMDa">Node.jsì™€ Rustì˜ ìš°ì•„í•œ ê²°í•© napi-rs</h1><p>2022-08-16</p><p><a href="https://github.com/napi-rs/napi-rs" target="_blank" rel="noopener noreferrer">napi-rs</a>ëŠ” Node APIë¥¼ ì´ìš©í•´ ëŸ¬ìŠ¤íŠ¸ë¡œ ì‘ì„±ëœ ì½”ë“œë¥¼ ë…¸ë“œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ë©‹ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì…ë‹ˆë‹¤.</p><h1>ë…¸ë“œ ì• ë“œì˜¨</h1><p>ë…¸ë“œì—ì„œ ë„¤ì´í‹°ë¸Œ í™•ì¥ ê¸°ëŠ¥ì€ <a href="https://nodejs.org/api/addons.html" target="_blank" rel="noopener noreferrer">ë…¸ë“œ ì• ë“œì˜¨</a>ì´ë¼ê³  í•©ë‹ˆë‹¤.
ë…¸ë“œ ì• ë“œì˜¨ì€ <code>.node</code> í™•ì¥ìë¥¼ ê°€ì§„ ë™ì  ë¼ì´ë¸ŒëŸ¬ë¦¬ ì…ë‹ˆë‹¤. ìœˆë„ìš°ì—ì„œëŠ” dll, ë§¥ì—ì„œëŠ” dylib, ë¦¬ëˆ…ìŠ¤ì—ì„œëŠ” soì™€ ë™ì¼í•©ë‹ˆë‹¤.</p><p>ë…¸ë“œì˜ <code>require</code> í•¨ìˆ˜ëŠ” <code>.node</code>í™•ì¥ìë¥¼ ë§Œë‚˜ë©´ ë™ì  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ íŒë‹¨í•˜ê³  ì´ˆê¸°í™” í•©ë‹ˆë‹¤. ê°œë°œìëŠ” ë…¸ë“œì™€ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆëŠ” ì½”ë“œë¥¼ ë§Œë“¤ê³  ì´ë¥¼ <code>.node</code>í™•ì¥ìë¥¼ ê°€ì§„ ë™ì  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ë§Œë“¤ë©´ ë„¤ì´í‹°ë¸Œ ê¸°ëŠ¥ì„ ë…¸ë“œì™€ ì—°ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><h1>ë…¸ë“œ ì• ë“œì˜¨ì˜ ê°„ë‹¨í•œ ì—­ì‚¬</h1><p>ë…¸ë“œì˜ ì• ë“œì˜¨ ê°œë°œì€ í—˜ë‚œí•œ ì—­ì‚¬ë¥¼ ê°€ì§€ê³  ìˆì–´ ë…¸ë“œì™€ ìƒí˜¸ì‘ìš© í•˜ëŠ” ë°©ë²•ì´ ì—¬ëŸ¬ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤. ì™œ Node APIê°€ ë‚˜ì™”ê³ , ìš°ë¦¬ëŠ” Node APIë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ì§€ ì•Œì•„ë´…ì‹œë‹¤.</p><h2>V8</h2><p>ì´ˆê¸° ë…¸ë“œ ì• ë“œì˜¨ì€ V8ì˜ í—¤ë”ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ì—¬ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ê·¸ëŸ°ë° V8ì˜ APIëŠ” V8ì— ë²„ì „ì— ë”°ë¼ì„œ ë„ˆë¬´ë‚˜ ë¹ ë¥´ê³  ë‹¤ì–‘í•˜ê²Œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ëŸ° ì´ìœ ë¡œ ë…¸ë“œ ì• ë“œì˜¨ì„ ìœ ì§€ ë³´ìˆ˜í•˜ëŠ” ì¼ì€ ì‰¬ìš´ì¼ì´ ì•„ë‹ˆì—ˆìŠµë‹ˆë‹¤.</p><h2>NAN</h2><blockquote><p>ì•„ë˜ì˜ ì½”ë“œëŠ” <a href="https://napi.rs/docs/deep-dive/history" target="_blank" rel="noopener noreferrer">napi-rs</a> ë¬¸ì„œì—ì„œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.</p></blockquote><p>ìœ„ì™€ ê°™ì€ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë…¸ë“œ 0.8ë²„ì „ë¶€í„° <a href="https://github.com/nodejs/nan" target="_blank" rel="noopener noreferrer">NAN</a>ì´ ë§Œë“¤ì–´ì¡ŒìŠµë‹ˆë‹¤. NANì€ Native Abstractions for Node.jsì˜ ì•½ìë¡œ, V8 APIë¥¼ ì¶”ìƒí™”í•˜ì—¬ ì„œë¡œ ë‹¤ë¥¸ V8ì—”ì§„ì´ë”ë¼ë„ <strong>ì½”ë“œì˜ ìˆ˜ì •ì—†ì´</strong> ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì œê³µí•˜ì˜€ìŠµë‹ˆë‹¤.</p><p>NANì€ C++ì˜ ë§¤í¬ë¡œì™€ í…œí”Œë¦¿ì„ ì´ìš©í•˜ì—¬ ì»´íŒŒì¼ì— ì„œë¡œ ë‹¤ë¥¸ ì½”ë“œë¡œ ë³€ê²½ í•©ë‹ˆë‹¤.</p><p>ì˜ˆë¥¼ë“¤ì–´ ì•„ë˜ì˜ ì½”ë“œëŠ”</p><div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token function">NAN_METHOD</span><span class="token punctuation">(</span>Echo<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span></code></pre></div><p>ë²„ì „ì— ë”°ë¼ ì»´íŒŒì¼ íƒ€ì„ì— ì„œë¡œ ë‹¤ë¥¸ ì½”ë“œë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.</p><div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp">Handle<span class="token operator">&lt;</span>Value<span class="token operator">&gt;</span> <span class="token function">Echo</span><span class="token punctuation">(</span><span class="token keyword">const</span> Arguments<span class="token operator">&amp;</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 0.10.x</span>
<span class="token keyword">void</span> <span class="token function">Echo</span><span class="token punctuation">(</span>FunctionCallbackInfo<span class="token operator">&lt;</span>Value<span class="token operator">&gt;</span><span class="token operator">&amp;</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 6.x</span></code></pre></div><p>ì´ë ‡ê²Œ NANì„ ì´ìš©í•˜ë©´ ë²„ì „ë³„ë¡œ <strong>ë‹¤ë¥¸ ì½”ë“œ</strong>ë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´, V8 ì˜ APIê°€ ë³€í•´ë„ NANì˜ ë²„ì „ë§Œ ì˜¬ë¦¬ë©´ ì½”ë“œì˜ ìˆ˜ì •ì—†ì´ ìƒˆë¡œìš´ V8ì—”ì§„ì— ëŒ€ì‘í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.
NANì€ ë„ë¦¬ ì‚¬ìš©ë˜ì—ˆìœ¼ë©°, ì§€ê¸ˆë„ ë…¸ë“œì˜ ë„¤ì´í‹°ë¸Œ ì§€ì›ì— ëŒ€í•´ ê²€ìƒ‰í•´ë³´ë©´ ë§ì€ íŠœí† ë¦¬ì–¼ì´ ë…¸ì¶œë˜ê³  ìˆìŠµë‹ˆë‹¤.</p><p>ê·¸ëŸ°ë° NANë„ ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. ì½”ë“œëŠ” í˜¸í™˜ë˜ì§€ë§Œ, ì»´íŒŒì¼í•œ ê²°ê³¼ë¬¼ì€ ì„œë¡œ ë‹¤ë¦…ë‹ˆë‹¤. V8ì˜ ë²„ì „ì´ ë‹¬ë¼ì§€ë©´ ì´ì „ ë²„ì „ì—ì„œ ì»´íŒŒì¼í•œ ë…¸ë“œ ì• ë“œì˜¨ì€ ìƒˆ ë²„ì „ì—ì„œ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ìƒˆ ë²„ì „ì—ì„œ ì‘ë™í•˜ë ¤ë©´ ë‹¤ì‹œ ì»´íŒŒì¼ì„ í•´ì•¼í–ˆìŠµë‹ˆë‹¤.
<strong>ì¦‰, ì„œë¡œ ë‹¤ë¥¸ ë…¸ë“œ ë²„ì „ê°„ ì½”ë“œëŠ” í˜¸í™˜ë˜ì§€ë§Œ ê²°ê³¼ë¬¼ì€ í˜¸í™˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</strong></p><p>ì´ì™€ ê°™ì€ ì´ìœ ë¡œ ë…¸ë“œ 8ë²„ì „ ì´ì „ì— node-sass ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í–ˆë‹¤ë©´, ë…¸ë“œì˜ ë²„ì „ì´ ì˜¬ë¼ê°”ì„ë•Œ ìƒˆë¡œìš´ ë²„ì „ì„ ë°›ê±°ë‚˜, <code>npm rebuild</code> ëª…ë ¹ì–´ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë‹¤ì‹œ ë¹Œë“œí•´ì•¼ì§€ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</p><h2>Node API (N-API)</h2><p>ì´ëŸ° ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ <a href="https://nodejs.org/api/n-api.html" target="_blank" rel="noopener noreferrer">N-API</a>ê°€ íƒ„ìƒí•˜ì˜€ìŠµë‹ˆë‹¤. N-APIëŠ” ë…¸ë“œ ë²„ì „ 8ë¶€í„° ë„ì…ë˜ì—ˆìœ¼ë©°, í˜„ì¬ëŠ” Node APIë¡œ ì´ë¦„ì´ ë³€ê²½ ë˜ì—ˆìŠµë‹ˆë‹¤. (ì´ì™€ ê°™ì€ ì´ìœ ë¡œ Node APIë³´ë‹¤ëŠ” N-APIë¡œ ê²€ìƒ‰í•˜ë©´ ë” ë‹¤ì–‘í•œ ìë£Œë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.)</p><p>Node APIì˜ ê°€ì¥ í° íŠ¹ì§•ì€ NANê³¼ ë‹¤ë¥´ê²Œ <a href="https://ko.wikipedia.org/wiki/%EC%9D%91%EC%9A%A9_%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8_%EC%9D%B4%EC%A7%84_%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4" target="_blank" rel="noopener noreferrer">ABI</a> í˜¸í™˜ì„±ì„ ê°€ì§„ë‹¤ëŠ” ì ì…ë‹ˆë‹¤. Node APIë¡œ ì‘ì„±ëœ ë…¸ë“œ ì• ë“œì˜¨ì€ ì¬ ì»´íŒŒì¼ì„ í•˜ì§€ ì•Šì•„ë„, ì„œë¡œ ë‹¤ë¥¸ ë²„ì „ì˜ ë…¸ë“œì—ì„œ ë¬¸ì œ ì—†ì´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>Node APIê°€ ê°€ì§€ëŠ” ë˜ ë‹¤ë¥¸ ì¥ì ì€, V8ì˜ APIë“¤ê³¼ ë…ë¦½ì ì¸ ì  ì…ë‹ˆë‹¤.</p><p>V8ì€ C++ë¡œ ì‘ì„±ë˜ì–´ ìˆì–´, ì—¬ëŸ¬ C++ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ì‚¬ìš©í•´ì•¼í•˜ì—¬ NANì€ C++ë¥¼ ì‚¬ìš©í•´ì•¼í–ˆìŠµë‹ˆë‹¤. Node APIëŠ” Cë¡œ ê°œë°œí•  ìˆ˜ ìˆë„ë¡ ì‘ì„±ë˜ì—ˆìœ¼ë©°, ë•ë¶„ì— ë‹¤ì–‘í•œ ì–¸ì–´ì—ì„œ í˜¸í™˜ì„±ì´ ë†’ì•„ì¡ŒìŠµë‹ˆë‹¤. (ì¼ë°˜ì ìœ¼ë¡œ Cì–¸ì–´ì— í˜¸í™˜ë˜ëŠ” FFIë¥¼ ë§Œë“œëŠ”ê²ƒì´ ë” ì‰½ìŠµë‹ˆë‹¤.)</p><p>ë˜ë‹¤ë¥¸ ì¥ì ì€ ë‹¤ë¥¸ JS ì—”ì§„ì„ ì‚¬ìš©í•´ë„ ë„¤ì´í‹°ë¸Œ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í˜¸í™˜ ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì‹¤ì œë¡œ ìµœê·¼ ì£¼ëª©ë°›ì•˜ë˜ ìƒˆë¡œìš´ JSëŸ°íƒ€ì„ <a href="https://github.com/oven-sh/bun" target="_blank" rel="noopener noreferrer">bun</a>ì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ìœ¼ë¡œ WebKitì˜ JavaScriptCoreë¥¼ ì‚¬ìš©í•˜ì§€ë§Œ <a href="https://github.com/oven-sh/bun#node-api-napi" target="_blank" rel="noopener noreferrer">Node APIë¥¼ êµ¬í˜„í•˜ì—¬</a> ë…¸ë“œ ì• ë“œì˜¨ë„ í˜¸í™˜ ë©ë‹ˆë‹¤.</p><p>ì´ëŸ° ì´ìœ ë¡œ í˜„ ì‹œì ì—ì„œ ë…¸ë“œì˜ ë„¤ì´í‹°ë¸Œ í™•ì¥ì„ ìœ„í•´ì„œëŠ” Node APIë¥¼ ì‚¬ìš©í•˜ëŠ”ê²ƒì´ ê°€ì¥ ì¢‹ìŠµë‹ˆë‹¤.</p><p>ê·¸ë ‡ë‹¤ë©´ napi-rsëŠ” ì–´ë–»ê²Œ ëŸ¬ìŠ¤íŠ¸ì™€ Node APIë¥¼ ì´ì–´ì¤„ê¹Œìš”?</p><h1>ìš°ì•„í•œ API</h1><blockquote><p>ì´ ë¬¸ë‹¨ì˜ ë§ì€ ì½”ë“œëŠ” napi-rs ë¬¸ì„œì—ì„œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.</p></blockquote><p>napi-rsì˜ APIëŠ” ëŸ¬ìŠ¤íŠ¸ì™€ ë…¸ë“œë¥¼ í•œ ëª¸ì²˜ëŸ¼ ì´ì–´ ì¤ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë‘ ìˆ«ìë¥¼ ë”í•˜ëŠ” ëŸ¬ìŠ¤íŠ¸ í•¨ìˆ˜ë¥¼ ë…¸ë“œì—ì„œ ì‚¬ìš©í•˜ë„ë¡ ë§Œë“¤ì–´ë´…ì‹œë‹¤. ìš°ì„  ëŸ¬ìŠ¤íŠ¸ í•¨ìˆ˜ëŠ” ì•„ë˜ì™€ ê°™ì„ ê²ë‹ˆë‹¤.</p><div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">add_numbers</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span> m<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u32</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> n <span class="token operator">+</span> m<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div><p>ì´ì œ napi-rsë¥¼ ì‚¬ìš©í•´ ë…¸ë“œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë°”ê¿”ë´…ë‹ˆë‹¤.</p><div class="gatsby-highlight has-highlighted-lines" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">napi<span class="token punctuation">::</span>bindgen_prelude<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line"><span class="token attribute attr-name">#[napi]</span></span><span class="token keyword">fn</span> <span class="token function-definition function">add_numbers</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span> m<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u32</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> n <span class="token operator">+</span> m<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div><p><code>#[napi]</code> ë§¤í¬ë¡œë§Œ ì¶”ê°€í•œë‹¤ë©´ ì•„ì£¼ ê°„ë‹¨íˆ ë…¸ë“œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì½”ë“œë¡œ ë³€ê²½ë©ë‹ˆë‹¤!</p><p>ìœ„ ì½”ë“œëŠ” ë…¸ë“œì—ì„œ ì•„ë˜ ì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> addNumbers <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;./output.node&#x27;</span>

<span class="token comment">// out: 3</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">addNumbers</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div><p>íŠ¹ë³„í•œ ì§€ì •ì´ ì—†ë‹¤ë©´ napi-rsëŠ” í•¨ìˆ˜ì´ë¦„ì„ camelCaseë¡œ ë³€ê²½í•´ì¤ë‹ˆë‹¤.</p><p>ì°¸ê³ ë¡œ JSì˜ ì—¬ëŸ¬ ê¸°ë³¸í•¨ìˆ˜ê°€ camelCaseë¡œ ì‘ì„±ëœê²ƒê³¼ ë‹¬ë¦¬ ëŸ¬ìŠ¤íŠ¸ëŠ” í•¨ìˆ˜ì´ë¦„ì„ snake_caseë¡œ ì§“ëŠ”ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤. napi-rsë¥¼ ì´ìš©í•˜ë©´ ë‘ ì–¸ì–´ì—ì„œ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ì»¨ë²¤ì…˜ì„ ì§€í‚¤ë©´ì„œ ì½”ë”©í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.</p><p>napi-rsëŠ” ë” ë©‹ì§„ì¼ë„ ë„ì™€ì¤ë‹ˆë‹¤. ìš°ì„ , napi-rsëŠ” structë¥¼ classë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë°”ê¿”ì¤ë‹ˆë‹¤.</p><div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">napi<span class="token punctuation">::</span>bindgen_prelude<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[napi(js_name = <span class="token string">&quot;QueryEngine&quot;</span>)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">QueryEngine</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token attribute attr-name">#[napi(js_name = <span class="token string">&quot;QueryEngine&quot;</span>)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">JsQueryEngine</span> <span class="token punctuation">{</span>
  engine<span class="token punctuation">:</span> <span class="token class-name">QueryEngine</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[napi]</span>
<span class="token keyword">impl</span> <span class="token class-name">JsQueryEngine</span> <span class="token punctuation">{</span>
  <span class="token attribute attr-name">#[napi(factory)]</span>
  <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">with_initial_count</span><span class="token punctuation">(</span>count<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
    <span class="token class-name">JsQueryEngine</span> <span class="token punctuation">{</span> engine<span class="token punctuation">:</span> <span class="token class-name">QueryEngine</span><span class="token punctuation">::</span><span class="token function">with_initial_count</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token attribute attr-name">#[napi(constructor)]</span>
  <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
    <span class="token class-name">JsQueryEngine</span> <span class="token punctuation">{</span> engine<span class="token punctuation">:</span> <span class="token class-name">QueryEngine</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/// Class method</span>
  <span class="token attribute attr-name">#[napi]</span>
  <span class="token keyword">pub</span> <span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">query</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> query<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">napi<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>engine<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span>
  <span class="token punctuation">}</span>

  <span class="token attribute attr-name">#[napi(getter)]</span>
  <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">status</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">napi<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>engine<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token attribute attr-name">#[napi(setter)]</span>
  <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">count</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> count<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>engine<span class="token punctuation">.</span>count <span class="token operator">=</span> count<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p>ë…¸ë“œì—ì„  ì•„ë˜ê°™ì€ ì½”ë“œì²˜ëŸ¼ ì‚¬ìš© í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">QueryEngine</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">withInitialCount</span><span class="token punctuation">(</span>count<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> QueryEngine
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">query</span><span class="token punctuation">(</span>query<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span>
  <span class="token keyword">get</span> <span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span>
  <span class="token keyword">set</span> <span class="token function">count</span><span class="token punctuation">(</span>count<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div><p>ëŸ¬ìŠ¤íŠ¸ë„ ìë°”ìŠ¤í¬ë¦½íŠ¸ì²˜ëŸ¼ <code>async-await</code> í•¨ìˆ˜ë¥¼ ì§€ì›í•˜ëŠ”ë°ìš”, napi-rsëŠ” <code>async</code>í•¨ìˆ˜ë¥¼ ë…¸ë“œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">futures<span class="token punctuation">::</span>prelude<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">napi<span class="token punctuation">::</span>bindgen_prelude<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[napi]</span>
<span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">read_file_async</span><span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Buffer</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre></div><p>ì‹¬ì§€ì–´ ë…¸ë“œì˜ <code>Promise</code>ë¥¼ ëŸ¬ìŠ¤íŠ¸ ì½”ë“œì—ì„œ <code>await</code>í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•´ì£¼ê¸° ê¹Œì§€ í•©ë‹ˆë‹¤.</p><div class="gatsby-highlight" data-language="rust"><pre class="language-rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">napi<span class="token punctuation">::</span>bindgen_prelude<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[napi]</span>
<span class="token keyword">pub</span> <span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">async_plus_100</span><span class="token punctuation">(</span>p<span class="token punctuation">:</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> v <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token keyword">await</span><span class="token operator">?</span><span class="token punctuation">;</span>
  <span class="token class-name">Ok</span><span class="token punctuation">(</span>v <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div><div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> asyncPlus100 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;./output.node&#x27;</span>

<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">asyncPlus100</span><span class="token punctuation">(</span>
  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token comment">// 120</span></code></pre></div><p>ìœ„ì²˜ëŸ¼ napi-rsë¥¼ ì‚¬ìš©í•˜ë©´ <code>#[napi]</code>ì˜ ì¶”ê°€ë§Œìœ¼ë¡œ ì•„ì£¼ ìì—°ìŠ¤ëŸ½ê²Œ ëŸ¬ìŠ¤íŠ¸ì™€ ë…¸ë“œë¥¼ ì´ì–´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>ì–´ë–»ê²Œ ì´ëŸ°ì¼ì´ ê°€ëŠ¥í• ê¹Œìš”? ì´ê±´ ëŸ¬ìŠ¤íŠ¸ì˜ ê°•ë ¥í•œ ë§¤í¬ë¡œ ë•ë¶„ì…ë‹ˆë‹¤.</p><h2>macro</h2><p>ëŸ¬ìŠ¤íŠ¸ì˜ ë§¤í¬ë¡œëŠ” ì•„ì£¼ ê°•ë ¥í•©ë‹ˆë‹¤. C/C++ì˜ ë§¤í¬ë¡œëŠ” ë¬¸ìì—´ ì¹˜í™˜ ì •ë„ì˜ ê¸°ëŠ¥ì„ ê°€ì§€ëŠ”ë° ë¹„í•´ ëŸ¬ìŠ¤íŠ¸ì˜ ë§¤í¬ë¡œëŠ” ì½”ë“œì˜ ë§¥ë½ì„ ì´í•´í•  ìˆ˜ ìˆê³ , ì»´íŒŒì¼ íƒ€ì„ì— ê²½ê³ ë¥¼ ì¤„ ìˆ˜ë„ ìˆëŠ”ë“± ë©”íƒ€í”„ë¡œê·¸ë˜ë°ì„ ì§€ì›í•©ë‹ˆë‹¤.</p><p>napi-rsëŠ” rustì˜ ê°•ë ¥í•œ ë§¤í¬ë¡œë¥¼ ì‚¬ìš©í•´ <strong>ì»´íŒŒì¼ íƒ€ì„</strong>ì— í•¨ìˆ˜/í´ë˜ìŠ¤ì˜ ì´ë¦„, í•¨ìˆ˜ì˜ ì¸ì ë“± ì„ ë¶„ì„í•˜ê³ , ì ì ˆí•œ í—¬í¼í•¨ìˆ˜ë¥¼ ì‚½ì…í•˜ëŠ” ë“± ì½”ë“œë¥¼ ë³€í˜•í•´ Node APIë¥¼ ì‚¬ìš©í•˜ê²Œ í•´ì¤ë‹ˆë‹¤.</p><p>ëŸ¬ìŠ¤íŠ¸ì˜ ë§¤í¬ë¡œì— ëŒ€í•´ ë” ì•Œì•„ë³´ê³  ì‹¶ë‹¤ë©´ <a href="https://doc.rust-lang.org/book/first-edition/macros.html" target="_blank" rel="noopener noreferrer">ê³µì‹ë¬¸ì„œì˜ ë§¤í¬ë¡œ í•­ëª©</a>ê³¼ <a href="https://blog.cloudflare.com/ko-kr/writing-complex-macros-in-rust-reverse-polish-notation-ko-kr/" target="_blank" rel="noopener noreferrer">Rust ë¡œ ë³µì¡í•œ ë§¤í¬ë¡œë¥¼ ì‘ì„±í•˜ê¸°: ì—­í´ë€ë“œ í‘œê¸°ë²•</a>ê¸€ì„ ì¶”ì²œí•©ë‹ˆë‹¤.</p><h1>í¸ë¦¬í•œ ë¹Œë“œ / ë°°í¬ ì‹œìŠ¤í…œ</h1><p>napi-rsì˜ ë˜ë‹¤ë¥¸ ì¥ì ì€ í¸ë¦¬í•œ ë¹Œë“œ ì‹œìŠ¤í…œì…ë‹ˆë‹¤. napi-rsì˜ ë¹Œë“œ ì‹œìŠ¤í…œì€ ë…¸ë“œì—ì„œ ì£¼ë¡œ ì‚¬ìš©ë˜ëŠ” ë¹Œë“œ ì‹œìŠ¤í…œì˜ ë¶ˆí¸í•œ ì ê³¼ ë°°í¬ ë°©ë²•ì˜ ë¶ˆí¸í•œì ì„ í•´ê²°í•´ì¤ë‹ˆë‹¤.</p><h1>ê¸°ì¡´ ì‹œìŠ¤í…œì˜ ë¶ˆí¸í•œì </h1><p>ì£¼ë¡œ ì‚¬ìš©ë˜ëŠ” ê¸°ì¡´ ì‹œìŠ¤í…œë“¤ì€ ì•„ë˜ì™€ ê°™ì€ ë¬¸ì œë¥¼ ê°€ì§€ê³  ìˆì—ˆìŠµë‹ˆë‹¤.</p><h2>node-gyp</h2><p>ë…¸ë“œì˜ ë§ì€ ë„¤ì´í‹°ë¸Œ ì• ë“œì˜¨ì€ <a href="https://ko.wikipedia.org/wiki/GYP_(%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4)" target="_blank" rel="noopener noreferrer">GYP</a>ì™€ <code>gyp</code>ë¥¼ ë˜í•‘í•œ <code>node-gyp</code>ì„ ì´ìš©í•©ë‹ˆë‹¤. <code>gyp</code>ì€ í¬ë¡¬íŒ€ì—ì„œ ê°œë°œí•œ <strong>í¬ë¡œìŠ¤ í”Œë ›í¼</strong>ì„ ì§€ì›í•˜ëŠ” C/C++ ë¹Œë“œ ë„êµ¬ ì…ë‹ˆë‹¤.</p><p><code>gyp</code>ì˜ ì •ì˜ íŒŒì¼ì€ ë³µì¡í•  ë¿ë§Œ ì•„ë‹ˆë¼ íŒŒì´ì¬ê³¼ ê°™ì€ ì™¸ë¶€ ì˜ì¡´ì„±ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. gypì„ ë§Œë“  í¬ë¡¬íŒ€ë„ ìœ ì§€ë³´ìˆ˜ ë“±ì˜ ë¬¸ì œë¡œ ìƒˆë¡œìš´ ë¹Œë“œë„êµ¬ <a href="https://ko.wikipedia.org/wiki/GN_(%EB%B9%8C%EB%93%9C_%EC%8B%9C%EC%8A%A4%ED%85%9C)" target="_blank" rel="noopener noreferrer">GN</a>ì„ ê°œë°œí•´ GYPì„ ë”ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p><p>ì‹¤ì œë¡œ ë…¸ë“œì™€ denoë¥¼ ë§Œë“  Ryan Dahlì€ node.jsì—ì„œ í›„íšŒí•˜ëŠ” ê²ƒ ì¤‘ í•˜ë‚˜ë¡œ ê¼½ê¸°ë„ í–ˆìŠµë‹ˆë‹¤.</p><iframe style="aspect-ratio:16 / 9" src="https://www.youtube.com/embed/M3BM9TB-8yA?cc_lang_pref=ko&amp;cc_load_policy=1&amp;start=420" title="YouTube video player" frameBorder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" class="c-bHVmPA"></iframe><p>ìœ„ì™€ ê°™ì€ ì´ìœ ë¡œ ë…¸ë“œ ì• ë“œì˜¨ ê°œë°œì— <a href="https://github.com/cmake-js/cmake-js" target="_blank" rel="noopener noreferrer">cmake-js</a>ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ë„ ìˆìŠµë‹ˆë‹¤.</p><h2>íŒ¨í‚¤ì§€ ë°°í¬ì˜ ë¬¸ì œ</h2><p>ìœ„ì—ì„œ ì„¤ëª…í•œ ê²ƒì²˜ëŸ¼ NANì€ ì†ŒìŠ¤ì½”ë“œëŠ” ì„œë¡œ ë‹¤ë¥¸ ë…¸ë“œë²„ì „ì´ë¼ë„ í˜¸í™˜ë˜ì§€ë§Œ, ì»´íŒŒì¼ëœ ê²°ê³¼ë¬¼ì€ í˜¸í™˜ ë˜ì§€ì•ŠìŠµë‹ˆë‹¤. ì´ì™€ê°™ì€ ë¬¸ì œë¡œ ë§ì€ íŒ¨í‚¤ì§€ë“¤ì´ C/C++ ì†ŒìŠ¤ì½”ë“œë¥¼ ì œê³µí•˜ê³  <code>postinstall</code>ì—ì„œ ì»´íŒŒì¼ í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë°°í¬ë˜ì—ˆìŠµë‹ˆë‹¤.</p><p>ì¡°ê¸ˆ ë” ì„¸ë ¨ëœ ë°©ì‹ì€ <a href="https://github.com/mapbox/node-pre-gyp" target="_blank" rel="noopener noreferrer">node-pre-gyp</a>ì„ ì´ìš©í•´ ì‚¬ì „ì— ì»´íŒŒì¼ëœ ë°”ì´ë„ˆë¦¬ê°€ ìˆë‹¤ë©´ CDNì—ì„œ ë°›ì•„ì˜¤ê³ , ë§Œì•½ ë°›ì•„ì˜¤ëŠ”ë° ì‹¤íŒ¨í•œë‹¤ë©´ ì»´íŒŒì¼ì„ í•˜ëŠ” ë°©ì‹ë„ ë„ë¦¬ ì´ìš©ë©ë‹ˆë‹¤.</p><p>ì•„ë§ˆ ì—¬ëŸ¬ë¶„ì˜ ë…¸ë“œ í”„ë¡œì íŠ¸ë¥¼ ë³´ì‹œë©´ ì¢…ì¢… <code>node_modules</code>ë‚´ë¶€ì— <code>node-gyp</code>ë˜ëŠ” <code>node-pre-gyp</code>ì´ ë³´ì¼ê²ë‹ˆë‹¤.</p><p>ì´ëŸ° ë°©ì‹ì€ ëª‡ê°€ì§€ ë¬¸ì œì ì´ ìˆìŠµë‹ˆë‹¤.
ìš°ì„ , ëŸ°íƒ€ì„ì— ë¶ˆí•„ìš”í•œ ë„êµ¬ë“¤ì„ ì„¤ì¹˜í•´ì•¼í•©ë‹ˆë‹¤. <code>node-gyp</code>ì„ ì‚¬ìš©í•˜ë ¤ë©´ íŒŒì´ì¬, make, gccë“±ì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ì´ëŸ° ì´ìœ ë¡œ ë…¸ë“œë§Œ ì‚¬ìš©í•˜ëŠ” ë„ì»¤ ì´ë¯¸ì§€ì— íŒŒì´ì¬ê³¼ makeë“±ì´ ì¶”ê°€ë¡œ ì„¤ì¹˜ë˜ì–´ ìš©ëŸ‰ì˜ ì¦ê°€ì™€ ê´€ë¦¬ì— ì–´ë ¤ì›€ì„ ê²ªê¸°ë„ í•©ë‹ˆë‹¤. cmake-jsë¥¼ ì´ìš©í•´ë„ C/C++ ì†ŒìŠ¤ë¥¼ ë°°í¬í•œë‹¤ë©´ ëŸ°íƒ€ì„ì— ë¶ˆí•„ìš”í•œ ë„êµ¬ë¥¼ ì„¤ì¹˜í•´ì•¼í•œë‹¤ëŠ”ì ì€ ë™ì¼í•©ë‹ˆë‹¤.</p><p>CDNì„ í™œìš©í•˜ëŠ” ë°©ë²•ë„ CDNì˜ ì†ë„ë‚˜ ë°©í™”ë²½ë“±ì˜ ë¬¸ì œë¥¼ ê²ªì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë§ˆ AWS S3ë¦¬ì „ì´ ë¶ë¯¸ë“± ë¨¼ ì§€ì—­ìœ¼ë¡œ ë˜ì–´ìˆì–´ ì„¤ì¹˜ê°€ ì•„ì£¼ ì˜¤ë˜ ê±¸ë¦° ê²½í—˜ì„ í•´ë³¸ ë¶„ë“¤ë„ ë§ì´ ê³„ì‹¤ê²ë‹ˆë‹¤.</p><h1>napi-rsì˜ ë¹Œë“œ/ë°°í¬ ì‹œìŠ¤í…œ</h1><p>napi-rsëŠ” <a href="https://github.com/evanw/esbuild/tree/master/npm" target="_blank" rel="noopener noreferrer">esbuild</a>ì²˜ëŸ¼ ì—¬ëŸ¬ í”Œë«í¼ì˜ íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•˜ë©°, ì´ë¥¼ ê¸°ë³¸ íŒ¨í‚¤ì§€ì˜ <code>optionalDependencies</code>ì— ì¶”ê°€í•˜ê³  ë°”ì¸ë”© ì½”ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p><p>ì‚¬ìš©ìëŠ” ê¸°ë³¸ íŒ¨í‚¤ì§€ë§Œ ì„¤ì¹˜í•˜ë©´ <code>optionalDependencies</code>ë„ ì„¤ì¹˜ë˜ë©°, ê¸°ë³¸ íŒ¨í‚¤ì§€ì— í•´ë‹¹ í”Œë«í¼ì— ë§ëŠ” íŒŒì¼ì„ ê³¨ë¼ ì‹¤í–‰í•˜ëŠ” ì½”ë“œê°€ ìˆì–´ í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ì‹¤í–‰í•˜ê²Œ ë©ë‹ˆë‹¤.</p><p>ì´ ë°©ë²•ì€ npmì„ ì´ìš©í•˜ê¸° ë•Œë¬¸ì— ë°©í™”ë²½ ì„¤ì •ì´ë‚˜ ì†ë„ì—ì„œ ì´ì ì´ ìˆê³ , íŠ¹ì • í”Œë ›í¼ì˜ ë¹Œë“œê°€ ë³µì¡í•˜ë‹¤ë©´ ë”°ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.</p><p><code>optionalDependencies</code>ë¥¼ ì‚¬ìš©í•˜ê¸°ë•Œë¬¸ì— ë°°í¬ì‹œ ì„¤ì¹˜ë˜ì§€ ì•Šì•„ë„ ë¬¸ì œì—†ì´ ë„˜ì–´ê°€ëŠ” íŠ¹ì§•ì´ ìˆì–´, ì„¤ë ¹ ë‹¤ë¥¸ í”Œë«í¼ì˜ íŒ¨í‚¤ì§€ë¥¼ ëª» ê°€ì ¸ì™€ë„ ë™ì‘í•˜ì§€ë§Œ ë§Œì•½ ì´ ê¸°ëŠ¥ì´ ë¶ˆì•ˆí•˜ì‹œë‹¤ë©´ ê¸°ë³¸ íŒ¨í‚¤ì§€ì— ì—¬ëŸ¬ í”Œë«í¼ì— ë§ëŠ” <code>.node</code>íŒŒì¼ì„ ë§Œë“¤ì–´ë„ ë©ë‹ˆë‹¤. napi-rsê°€ ìƒì„±í•˜ëŠ” ë°”ì¸ë”© ì½”ë“œëŠ” <code>some-package-darwin-x64.node</code> ê°™ì€ íŒŒì¼ì„ ë¨¼ì € íƒìƒ‰í•˜ê³  í•´ë‹¹íŒŒì¼ì´ ì—†ë‹¤ë©´ <code>@some-package/darwin-x64</code>íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ê¸° ë•Œë¬¸ì— í•œ íŒ¨í‚¤ì§€ì— ëª¨ë“  í”Œë ›í¼ì„ ì§€ì›í•˜ë„ë¡ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p><p>ê·¸ë¦¬ê³  ì›í•œë‹¤ë©´ ìœ„ ê³¼ì •ì„ ìë™ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” GitHub Action ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤.</p><h3>Tip</h3><p>ì°¸ê³   ë¡œ yarnì„ ì‚¬ìš©í•œë‹¤ë©´ 3.1 ë²„ì „ë¶€í„° <a href="https://dev.to/arcanis/yarn-31-corepack-esm-pnpm-optional-packages--3hak#conditional-packages" target="_blank" rel="noopener noreferrer">supportedArchitectures</a> ì„¤ì •ì„ í†µí•´ ë¶ˆí•„ìš”í•œ <code>optionalDependencies</code>ë¥¼ ë°›ì§€ ì•Šë„ë¡ ì„¤ì • í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><h2>TypeScript</h2><p>napi-rsì˜ ë¹Œë“œ ì‹œìŠ¤í…œì˜ ë˜ ë‹¤ë¥¸ ì¥ì ì€ ëŸ¬ìŠ¤íŠ¸ ì½”ë“œë¥¼ ë³´ê³  íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ì§€ì›ì„ ìœ„í•œ <code>.d.ts</code>ì„ ìë™ìœ¼ë¡œ ìƒì„±í•´ì¤ë‹ˆë‹¤. ì´ ì—­ì‹œ ëŸ¬ìŠ¤íŠ¸ì˜ ë§¤í¬ë¡œë¥¼ í™œìš©í•˜ì—¬ í•¨ìˆ˜ì˜ ì •ë³´ë¥¼ ë°›ì•„ì™€ ìƒì„±í•´ì¤ë‹ˆë‹¤.</p><h2>Cargo = â¤ï¸</h2><p>ë§ˆì§€ë§‰ìœ¼ë¡œ napi-rsì˜ ì¥ì ì€ ëŸ¬ìŠ¤íŠ¸ì˜ ê°œë°œí™˜ê²½ ì…ë‹ˆë‹¤. <a href="https://github.com/hahnlee/canter" target="_blank" rel="noopener noreferrer">canter</a>ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°œë°œí•˜ë˜ ë„ì¤‘ <code>Objective-C</code>ë¡œ ê°œë°œëœ ì½”ë“œì™€ ì—°ë™í•  ì¼ì´ ë§ì•„ ì°¨ë¼ë¦¬ C/C++/Obj-Cë¡œ ê°œë°œí™˜ê²½ì„ ë°”ê¿€ê¹Œ í•˜ëŠ” ê³ ë¯¼ì„ ë§ì´ í–ˆì—ˆëŠ”ë°ìš”, ê°œë°œì„ í•˜ë©´ ì ì  ë” ê·¸ëŸ° ê³ ë¯¼ì´ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤.</p><p>C/C++ì— ë¹„í•´ Cargoë¼ëŠ” í‘œì¤€ì , í˜„ëŒ€ì ì¸ íŒ¨í‚¤ì§€ë§¤ë‹ˆì € ë•ë¶„ì— ë‹¤ì–‘í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì—ˆê³ , ê°œë°œí™˜ê²½ì„ ì„¤ì¹˜í•˜ê¸° ìœ„í•œ ê³¼ì •ë„ ëª¹ì‹œ ê°„ë‹¨í•œë°ë‹¤ í¬ë¡œìŠ¤í”Œë«í¼ ë¹Œë“œë„ ë” ê°„ë‹¨í•©ë‹ˆë‹¤.</p><p>ëŸ¬ìŠ¤íŠ¸ì–¸ì–´ë„ ë‹¤ì–‘í•œ ìë£Œêµ¬ì¡°, ì•ˆì „í•¨ì„ ì œê³µí•˜ëŠ”ê²ƒë„ ë§¤ë ¥ì´ê³ ìš”.</p><p>C/C++ ì—°ë™ë„ ëŸ¬ìŠ¤íŠ¸ì™€ Cargoì˜ ê¸°ëŠ¥ë§Œìœ¼ë¡œë„ ê°€ëŠ¥í•˜ì§€ë§Œ, ë³µì¡í•œ ê²½ìš°ì—ë„ <a href="https://github.com/rust-lang/cc-rs" target="_blank" rel="noopener noreferrer">cc</a>ê°™ì€ ë„êµ¬ë¥¼ ì´ìš©í•˜ë©´ ë¹„êµì  ì–´ë µì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
Rustì™€ í•¨ê»˜ ì‚¬ìš©í•  C/C++ ì½”ë“œê°€ í¬ë¡œìŠ¤ í”Œë ›í¼ ë¹Œë“œê°€ í•„ìš”í•˜ë‹¤ë©´ napi-rsì˜ --zig ì˜µì…˜ì„ í†µí•´ <code>zig cc</code>ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. (zig ccë„ ì •ë§ ë©‹ì§„ë„êµ¬ ì…ë‹ˆë‹¤! ë”°ë¡œ ì†Œê°œí•  ì˜ˆì •ì´ë‹ˆ ê¸°ëŒ€í•´ì£¼ì„¸ìš” ğŸ˜†)</p><p>ë§Œì•½ ë„¤ì´í‹°ë¸Œ ì—°ë™ì´ í•„ìš”í•˜ì‹œë‹¤ë©´ ëŸ¬ìŠ¤íŠ¸ì™€ napi-rsë¥¼ í•œë²ˆ ì‚¬ìš©í•´ë³´ì„¸ìš”. ì•„ë§ˆ í›„íšŒí•˜ì§€ ì•Šì„ê²ë‹ˆë‹¤.</p></article><div class="c-jEDjTQ"><img src="/images/profile.png" draggable="false" alt="" class="c-dvRuTq"/><div class="c-bZcNek"><h2 class="c-jwOSHF">ì´í•œ</h2><p class="c-dMmbPO">Coding a Better World Together</p><a role="menuitem" href="https://hanlee.io" class="c-euCchw">About</a><a role="menuitem" href="https://github.com/hahnlee" class="c-euCchw">GitHub</a><a role="menuitem" href="/rss.xml" class="c-euCchw">RSS</a></div></div></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-111601591-4', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2022/napi-rs";window.___webpackCompilationHash="daf554781773296ec359";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-38856857010c707155ba.js"],"app":["/app-ffbf6f45867c65215e0e.js"],"component---src-containers-post-tsx":["/component---src-containers-post-tsx-355c941244c34af25b94.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-87b3ba1c8c14ae231405.js"]};/*]]>*/</script><script src="/polyfill-38856857010c707155ba.js" nomodule=""></script><script src="/app-ffbf6f45867c65215e0e.js" async=""></script><script src="/framework-043a7c4ea56bed9a642b.js" async=""></script><script src="/webpack-runtime-e753762912d8057d923a.js" async=""></script></body></html>